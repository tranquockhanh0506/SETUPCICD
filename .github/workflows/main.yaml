#name: Build & Release
#
#on:
#  push:
#    branches:
#      - CICD
#
#jobs:
#  build:
#    name: Build & Release
#    runs-on: ubuntu-latest
#
#    steps:
#      - uses: actions/checkout@v1
#
#      - uses: actions/setup-java@v1
#        with:
#           java-version: '12.x'
#
#
#      - uses: subosito/flutter-action@v1
#        with:
#          channel: 'stable'
#
#      - id: read-version
#        uses: NiklasLehnfeld/flutter-version-number-action@main
#        with:
#          file-path: pubspec.yaml
#      - run: echo "version ${{ steps.read-version.outputs.version-number }}"
#
#      - run: flutter clean
#      - run: flutter pub get
#      - run: flutter build apk --release
#
#      - name: upload artefact to App Center
#        uses: wzieba/AppCenter-Github-Action@v1
#        with:
#          appName: ${{secrets.ANDROID_APP_NAME}}
#          token: ${{secrets.APP_CENTER_TOKEN}}
#          group: Collaborators
#          file: build/app/outputs/flutter-apk/app-release.apk
#          notifyTesters: true
#          releaseNotes: new release
#          debug: true
name: App Center

on:
  push:
    branches:
      - CICD

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Set up Flutter
        uses: subosito/flutter-action@v2
        with:
          channel: 'stable'
      - name: Install dependencies
      - run: flutter clean
      - run: flutter pub get
      - run: flutter build apk --release
      - name: Build APK
      - name: Upload to App Center
        run: |
          appcenter distribute release --file build/app/outputs/flutter-apk/app-release.apk --token ${{ secrets.APP_CENTER_TOKEN }} --group Collaborators



#      - name: upload Deploygate
#        uses: jmatsu/dg-upload-app-action@v0.2.2
#        with:
#          app_owner_name: KhanhTQ
#          api_token: ${{ secrets.DEPLOYGATE_API_TOKEN }}
#          app_file_path: "build/app/outputs/flutter-apk/app-release.apk"
#          package_name: "CICD"
#          message: "cicd"

